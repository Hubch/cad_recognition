# 权利要求书
## 一种基于人工智能的CAD自动化在线审图匹配算法、流程、网站和系统

1. 一种基于人工智能的CAD自动化在线审图匹配算法、流程、网站和系统，用于通过多阶段方法分析任意两幅或多幅图像或 PDF 格式存储的 CAD 文件，以判断其是否描述同一实体，该系统包括：
     - 前端模块，用于用户界面展示和交互，提供文件上传、匹配结果展示和用户反馈接口；
     - 后端模块，处理用户请求并协调各模块的工作，包括接收前端请求、调用模型侧服务模块和返回匹配结果；
     - 模型侧服务模块，包含以下子模块：
         - 目标检测子模块，使用预训练的 YOLOv5 模型进行目标检测，该模型通过以下步骤进行训练和优化：
         - 使用自适应直方图均衡（CLAHE）、随机水平翻转、随机旋转、随机仿射变换、随机裁剪、颜色抖动、随机擦除和归一化等数据增强技术对图像进行预处理；
         - 通过数据集的划分和样本均衡策略，使用加权随机采样技术平衡训练数据集的类别分布，进行 YOLOv5 模型的训练和优化；
         - 通过 onnxruntime 实时推理提供服务，确保高效的目标检测，并对检测结果进行后处理，包括非极大值抑制（NMS）以去除冗余检测框；
   - 图像匹配和分类子模块，使用共享特征提取骨干网络（backbone）的双头输出模型进行图像匹配和分类，该模型通过以下步骤进行训练、优化和推理：
       - 使用 TinyConvNeXt 作为教师网络和 MobileNetV2 作为学生网络，构建具有共享特征提取骨干网络的特征和对数几率（logits）双头输出模型；
       - 构建包含样本均衡和数据增广的三元组复杂数据集，通过过采样和欠采样技术平衡样本分布，使用滑动窗口技术处理超大尺寸图像；
       - 使用多种复杂损失函数进行优化，包括带困难样本挖掘的三元组损失（对正样本和负样本之间的距离进行优化）、增强同类样本内聚性的 Arcface 损失、NTXen 损失（用于自监督学习）、类别敏感的交叉熵损失、用于教师网络模型训练的基于自监督学习的对比损失函数（BYOL），以及用于学生网络训练的特征蒸馏和对数几率蒸馏损失（通过最小化学生网络和教师网络输出之间的差异进行优化），以及用于抑制过拟合的模型参数 L2 正则化损失；
       - 采用 Lookahead 和 AdaBelief 组合优化器进行模型训练，并使用 ReduceLROnPlateau 学习率衰减策略；
       - 采用混合精度训练策略，以减少内存占用和加快训练速度；
       - 教师-学生网络知识蒸馏训练策略，用于减少推理时的性能占用和提高推理效率，包括在训练过程中将教师网络的知识传递给学生网络，通过对比学习和蒸馏技术提升模型的泛化能力；
       - 滑窗检测和局域坐标-全局坐标转换子模块，用于处理超大尺寸图像的目标检测任务，滑窗检测过程中包括局域坐标到全局坐标的转换，并进行全局非极大值抑制（NMS）以消除冗余检测框；
       - 图像尺寸对齐预处理子模块，用于匹配两幅图像中目标的位置，通过调整图像尺寸以实现对齐预处理，确保目标位置的准确对齐；
       - 特征匹配子模块，基于余弦距离及阈值优化方法进行特征匹配，包括计算特征向量之间的余弦相似度，并根据精确率和召回率的综合指标（F1 分数）优化匹配阈值，以实现高精度的特征匹配；
   - onnxruntime 实时推理模块，用于提供在线推理服务，确保系统的实时性和高效性。
2.	根据权利要求1所述的 CAD 审图匹配系统，其中所述的前端模块提供文件上传、匹配结果展示和用户反馈接口，用户能够通过图形用户界面（GUI）上传 CAD 文件，查看匹配结果并提供反馈。
3.	根据权利要求1所述的 CAD 审图匹配系统，其中所述的后端模块接收前端模块的请求，调用模型侧服务模块进行处理，并将处理结果返回给前端模块，包括接收 CAD 文件、调用目标检测和图像匹配模型，并返回匹配结果。
4.	根据权利要求1所述的 CAD 审图匹配系统，其中所述的目标检测子模块使用预训练的 YOLOv5 模型，通过自适应直方图均衡（CLAHE）、随机水平翻转、随机旋转、随机仿射变换、随机裁剪、颜色抖动、随机擦除和归一化等数据增强技术对图像进行预处理，并通过数据集划分和样本均衡策略优化训练过程，使用滑动窗口技术处理超大尺寸图像，并通过 onnxruntime 提供实时推理服务。
5.	根据权利要求1所述的 CAD 审图匹配系统，其中所述的图像匹配和分类子模块使用共享特征提取骨干网络（backbone）的双头输出模型进行图像匹配和分类，包括使用 TinyConvNeXt 作为教师网络和 MobileNetV2 作为学生网络，构建具有共享特征提取骨干网络的特征和对数几率（logits）双头输出模型。
6.	根据权利要求1所述的 CAD 审图匹配系统，其中所述的图像匹配和分类子模块通过构建包含样本均衡和数据增广的三元组复杂数据集进行训练，并使用带困难样本挖掘的三元组损失、Arcface 损失、NTXen 损失、类别敏感的交叉熵损失、用于教师网络模型训练的基于自监督学习的对比损失函数（BYOL），以及用于学生网络训练的特征蒸馏和对数几率蒸馏损失进行优化。
7.	根据权利要求1所述的 CAD 审图匹配系统，其中所述的图像匹配和分类子模块采用 Lookahead 和 AdaBelief 组合优化器进行模型训练，并使用 ReduceLROnPlateau 学习率衰减策略进行优化。
8.	根据权利要求1所述的 CAD 审图匹配系统，其中所述的图像匹配和分类子模块采用混合精度训练策略，以减少内存占用和加快训练速度。
9.	根据权利要求1所述的 CAD 审图匹配系统，其中所述的教师-学生网络知识蒸馏训练策略用于减少推理时的性能占用和提高推理效率，通过对比学习和蒸馏技术在训练过程中将教师网络的知识传递给学生网络，包括使用基于自监督学习的对比损失函数（BYOL）进行教师网络训练，和使用特征蒸馏及对数几率蒸馏损失进行学生网络训练。
10.	根据权利要求1所述的 CAD 审图匹配系统，其中所述的滑窗检测和局域坐标-全局坐标转换子模块用于处理超大尺寸图像的目标检测任务，通过滑窗检测实现局域坐标到全局坐标的转换，并进行全局非极大值抑制（NMS）以消除冗余检测框，提高检测精度。
11.	根据权利要求1所述的 CAD 审图匹配系统，其中所述的图像尺寸对齐预处理子模块用于匹配两幅图像中目标的位置，通过调整图像尺寸以实现对齐预处理，确保目标位置的准确对齐。
12.	根据权利要求1所述的 CAD 审图匹配系统，其中所述的特征匹配子模块使用余弦距离及阈值优化方法进行特征匹配，通过计算特征向量之间的余弦相似度，并根据精确率（Precision）和召回率（Recall）的综合指标（F1 分数）优化匹配阈值，以实现高精度的特征匹配。
13.	根据权利要求1所述的 CAD 审图匹配系统，其中所述的 onnxruntime 实时推理模块用于提供在线推理服务，确保系统的实时性和高效性，并通过优化的推理流水线提升系统的整体性能。
